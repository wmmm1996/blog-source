---
title: ç­–ç•¥æ¨¡å¼-Strategy Pattern
date: 2019-01-19 20:03:11
tags:
  - java
  - è®¾è®¡æ¨¡å¼
categories: 
  - ç†è®ºå­¦ä¹ 
  - JAVAè®¾è®¡æ¨¡å¼
---

# æ¦‚è¿°

> å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ç±»ï¼Œå°†æ¯ä¸€ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œå¹¶è®©å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œç­–ç•¥æ¨¡å¼è®©ç®—æ³•ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·è€Œå˜åŒ–ï¼Œä¹Ÿç§°ä¸ºæ”¿ç­–æ¨¡å¼(Policy)ã€‚

<!-- more -->

# ç»„æˆ

- Contextï¼ˆç¯å¢ƒç±»ï¼‰
> ç¯å¢ƒç±»æ˜¯ä½¿ç”¨ç®—æ³•çš„è§’è‰²ï¼Œå®ƒåœ¨è§£å†³æŸä¸ªé—®é¢˜ï¼ˆå³å®ç°æŸä¸ªæ–¹æ³•ï¼‰æ—¶å¯ä»¥é‡‡ç”¨å¤šç§ç­–ç•¥ã€‚åœ¨ç¯å¢ƒç±»ä¸­ç»´æŒä¸€ä¸ªå¯¹æŠ½è±¡ç­–ç•¥ç±»çš„å¼•ç”¨å®ä¾‹ï¼Œç”¨äºå®šä¹‰æ‰€é‡‡ç”¨çš„ç­–ç•¥ã€‚
- Strategyï¼ˆæŠ½è±¡ç­–ç•¥ç±»ï¼‰
> å®ƒä¸ºæ‰€æ”¯æŒçš„ç®—æ³•å£°æ˜äº†æŠ½è±¡æ–¹æ³•ï¼Œæ˜¯æ‰€æœ‰ç­–ç•¥ç±»çš„çˆ¶ç±»ï¼Œå®ƒå¯ä»¥æ˜¯æŠ½è±¡ç±»æˆ–å…·ä½“ç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯æ¥å£ã€‚ç¯å¢ƒç±»é€šè¿‡æŠ½è±¡ç­–ç•¥ç±»ä¸­å£°æ˜çš„æ–¹æ³•åœ¨è¿è¡Œæ—¶è°ƒç”¨å…·ä½“ç­–ç•¥ç±»ä¸­å®ç°çš„ç®—æ³•ã€‚
- ConcreteStrategyï¼ˆå…·ä½“ç­–ç•¥ç±»ï¼‰
> å®ƒå®ç°äº†åœ¨æŠ½è±¡ç­–ç•¥ç±»ä¸­å£°æ˜çš„ç®—æ³•ï¼Œåœ¨è¿è¡Œæ—¶ï¼Œå…·ä½“ç­–ç•¥ç±»å°†è¦†ç›–åœ¨ç¯å¢ƒç±»ä¸­å®šä¹‰çš„æŠ½è±¡ç­–ç•¥ç±»å¯¹è±¡ï¼Œä½¿ç”¨ä¸€ç§å…·ä½“çš„ç®—æ³•å®ç°æŸä¸ªä¸šåŠ¡å¤„ç†ã€‚

# é€‚ç”¨åœºæ™¯

-  ä¸€ä¸ªç³»ç»Ÿéœ€è¦åŠ¨æ€åœ°åœ¨å‡ ç§ç®—æ³•ä¸­é€‰æ‹©ä¸€ç§
> ä¸€ä¸ªç³»ç»Ÿéœ€è¦åŠ¨æ€åœ°åœ¨å‡ ç§ç®—æ³•ä¸­é€‰æ‹©ä¸€ç§ï¼Œé‚£ä¹ˆå¯ä»¥å°†è¿™äº›ç®—æ³•å°è£…åˆ°ä¸€ä¸ªä¸ªçš„å…·ä½“ç®—æ³•ç±»ä¸­ï¼Œè€Œè¿™äº›å…·ä½“ç®—æ³•ç±»éƒ½æ˜¯ä¸€ä¸ªæŠ½è±¡ç®—æ³•ç±»çš„å­ç±»ã€‚æ¢è¨€ä¹‹ï¼Œè¿™äº›å…·ä½“ç®—æ³•ç±»å‡æœ‰ç»Ÿä¸€çš„æ¥å£ï¼Œæ ¹æ®â€œé‡Œæ°ä»£æ¢åŸåˆ™â€å’Œé¢å‘å¯¹è±¡çš„å¤šæ€æ€§ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€‰æ‹©ä½¿ç”¨ä»»ä½•ä¸€ä¸ªå…·ä½“ç®—æ³•ç±»ï¼Œå¹¶åªéœ€è¦ç»´æŒä¸€ä¸ªæ•°æ®ç±»å‹æ˜¯æŠ½è±¡ç®—æ³•ç±»çš„å¯¹è±¡ã€‚
- ä¸€ä¸ªå¯¹è±¡æœ‰å¾ˆå¤šçš„è¡Œä¸º
> ä¸€ä¸ªå¯¹è±¡æœ‰å¾ˆå¤šçš„è¡Œä¸ºï¼Œå¦‚æœä¸ç”¨æ°å½“çš„æ¨¡å¼ï¼Œè¿™äº›è¡Œä¸ºå°±åªå¥½ä½¿ç”¨å¤šé‡æ¡ä»¶é€‰æ‹©è¯­å¥æ¥å®ç°ã€‚æ­¤æ—¶ï¼Œä½¿ç”¨ç­–ç•¥æ¨¡å¼ï¼ŒæŠŠè¿™äº›è¡Œä¸ºè½¬ç§»åˆ°ç›¸åº”çš„å…·ä½“ç­–ç•¥ç±»é‡Œé¢ï¼Œå°±å¯ä»¥é¿å…ä½¿ç”¨éš¾ä»¥ç»´æŠ¤çš„å¤šé‡æ¡ä»¶é€‰æ‹©è¯­å¥ã€‚
- ä¸å¸Œæœ›å®¢æˆ·ç«¯çŸ¥é“å¤æ‚çš„ã€ä¸ç®—æ³•ç›¸å…³çš„æ•°æ®ç»“æ„
> åœ¨å…·ä½“ç­–ç•¥ç±»ä¸­å°è£…ç®—æ³•ä¸ç›¸å…³çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥æé«˜ç®—æ³•çš„ä¿å¯†æ€§ä¸å®‰å…¨æ€§ã€‚

# æ¡ˆä¾‹

ç”µå½±é™¢æ‰“æŠ˜æ–¹æ¡ˆ

```java
//ç”µå½±ç¥¨ç±»ï¼šç¯å¢ƒç±»
@Data
public class MovieTicket {
    private double price;
    private Discount discount; //ç»´æŒä¸€ä¸ªå¯¹æŠ½è±¡æŠ˜æ‰£ç±»çš„å¼•ç”¨

    public double getPrice() {
        //è°ƒç”¨æŠ˜æ‰£ç±»çš„æŠ˜æ‰£ä»·è®¡ç®—æ–¹æ³•
        return discount.calculate(this.price);
    }
}
//æŠ˜æ‰£ç±»ï¼šæŠ½è±¡ç­–ç•¥ç±»
public interface Discount {
    double calculate(double price);
}
//å­¦ç”Ÿç¥¨æŠ˜æ‰£ç±»ï¼šå…·ä½“ç­–ç•¥ç±»
public class StudentDiscount implements Discount {
    @Override
    public double calculate(double price) {
        System.out.println("å­¦ç”Ÿç¥¨ï¼š");
        return price * 0.8;
    }
}
//å„¿ç«¥ç¥¨æŠ˜æ‰£ç±»ï¼šå…·ä½“ç­–ç•¥ç±»
public class ChildrenDiscount implements Discount {
    @Override
    public double calculate(double price) {
        System.out.println("å„¿ç«¥ç¥¨ï¼š");
        return price - 10;
    }
}
//VIPä¼šå‘˜ç¥¨æŠ˜æ‰£ç±»ï¼šå…·ä½“ç­–ç•¥ç±»
public class VIPDiscount implements Discount {
    @Override
    public double calculate(double price) {
        System.out.println("VIPç¥¨ï¼š");
        System.out.println("å¢åŠ ç§¯åˆ†ï¼");
        return price * 0.5;
    }
}
```

å®¢æˆ·ç«¯ï¼š

```java
public class Client {
    public static void main(String[] args) {
        MovieTicket mt = new MovieTicket();
        double originalPrice = 60.0;

        mt.setPrice(originalPrice);
        System.out.println("åŸå§‹ä»·ä¸ºï¼š" + originalPrice);
        System.out.println("---------------------------------");

        Discount discount = new VIPDiscount();
        mt.setDiscount(discount); //æ³¨å…¥æŠ˜æ‰£å¯¹è±¡

        double currentPrice = mt.getPrice();
        System.out.println("æŠ˜åä»·ä¸ºï¼š" + currentPrice);
    }
}
```

è¾“å‡ºç»“æœï¼š

```
åŸå§‹ä»·ä¸ºï¼š60.0
---------------------------------
VIPç¥¨ï¼š
å¢åŠ ç§¯åˆ†ï¼
æŠ˜åä»·ä¸ºï¼š30.0
```

# ä¼˜ç¼ºç‚¹

## ä¼˜ç‚¹

- ç­–ç•¥æ¨¡å¼æä¾›äº†å¯¹â€œå¼€é—­åŸåˆ™â€çš„å®Œç¾æ”¯æŒ
> ç”¨æˆ·å¯ä»¥åœ¨ä¸ä¿®æ”¹åŸæœ‰ç³»ç»Ÿçš„åŸºç¡€ä¸Šé€‰æ‹©ç®—æ³•æˆ–è¡Œä¸ºï¼Œä¹Ÿå¯ä»¥çµæ´»åœ°å¢åŠ æ–°çš„ç®—æ³•æˆ–è¡Œä¸ºã€‚
- ç­–ç•¥æ¨¡å¼æä¾›äº†ç®¡ç†ç›¸å…³çš„ç®—æ³•æ—çš„åŠæ³•
> ç­–ç•¥ç±»çš„ç­‰çº§ç»“æ„å®šä¹‰äº†ä¸€ä¸ªç®—æ³•æˆ–è¡Œä¸ºæ—ï¼Œæ°å½“ä½¿ç”¨ç»§æ‰¿å¯ä»¥æŠŠå…¬å…±çš„ä»£ç ç§»åˆ°æŠ½è±¡ç­–ç•¥ç±»ä¸­ï¼Œä»è€Œé¿å…é‡å¤çš„ä»£ç ã€‚
- æä¾›äº†ä¸€ç§å¯ä»¥æ›¿æ¢ç»§æ‰¿å…³ç³»çš„åŠæ³•
- å¯ä»¥é¿å…å¤šé‡æ¡ä»¶é€‰æ‹©è¯­å¥
- æä¾›äº†ä¸€ç§ç®—æ³•çš„å¤ç”¨æœºåˆ¶
> ç”±äºå°†ç®—æ³•å•ç‹¬æå–å‡ºæ¥å°è£…åœ¨ç­–ç•¥ç±»ä¸­ï¼Œå› æ­¤ä¸åŒçš„ç¯å¢ƒç±»å¯ä»¥æ–¹ä¾¿åœ°å¤ç”¨è¿™äº›ç­–ç•¥ç±»ã€‚

# ç¼ºç‚¹

- å®¢æˆ·ç«¯å¿…é¡»çŸ¥é“æ‰€æœ‰çš„ç­–ç•¥ç±»ï¼Œå¹¶è‡ªè¡Œå†³å®šä½¿ç”¨å“ªä¸€ä¸ªç­–ç•¥ç±»ã€‚
> è¿™å°±æ„å‘³ç€å®¢æˆ·ç«¯å¿…é¡»ç†è§£è¿™äº›ç®—æ³•çš„åŒºåˆ«ï¼Œä»¥ä¾¿é€‚æ—¶é€‰æ‹©æ°å½“çš„ç®—æ³•ã€‚æ¢è¨€ä¹‹ï¼Œç­–ç•¥æ¨¡å¼åªé€‚ç”¨äºå®¢æˆ·ç«¯çŸ¥é“æ‰€æœ‰çš„ç®—æ³•æˆ–è¡Œä¸ºçš„æƒ…å†µã€‚
- å°†é€ æˆç³»ç»Ÿäº§ç”Ÿå¾ˆå¤šå…·ä½“ç­–ç•¥ç±»
> ä»»ä½•ç»†å°çš„å˜åŒ–éƒ½å°†å¯¼è‡´ç³»ç»Ÿè¦å¢åŠ ä¸€ä¸ªæ–°çš„å…·ä½“ç­–ç•¥ç±»ã€‚
- æ— æ³•åŒæ—¶åœ¨å®¢æˆ·ç«¯ä½¿ç”¨å¤šä¸ªç­–ç•¥ç±»
> ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ—¶ï¼Œå®¢æˆ·ç«¯æ¯æ¬¡åªèƒ½ä½¿ç”¨ä¸€ä¸ªç­–ç•¥ç±»ï¼Œä¸æ”¯æŒä½¿ç”¨ä¸€ä¸ªç­–ç•¥ç±»å®Œæˆéƒ¨åˆ†åŠŸèƒ½åå†ä½¿ç”¨å¦ä¸€ä¸ªç­–ç•¥ç±»æ¥å®Œæˆå‰©ä½™åŠŸèƒ½çš„æƒ…å†µã€‚

# æ‰©å±•

## ç­–ç•¥æšä¸¾
> ä½¿ç”¨ç­–ç•¥æšä¸¾å®ç°ç®€å•çš„è®¡ç®—å™¨

```java
public enum Calculator {
    /**
     * åŠ 
     */
    ADD{
        @Override
        public double calculate(double d1, double d2) {
            return d1 + d2;
        }
    },
    /**
     * å‡
     */
    SUB {
        @Override
        public double calculate(double d1, double d2) {
            return d1 - d2;
        }
    },
    /**
     * ä¹˜
     */
    MULTY {
        @Override
        public double calculate(double d1, double d2) {
            return d1 * d2;
        }
    },
    /**
     * é™¤æ³•
     */
    DIVIDE {
        @Override
        public double calculate(double d1, double d2) {
            return d1 / d2;
        }
    };

    public abstract double calculate(double d1,double d2);
}
```

æµ‹è¯•ç±»:

```java
public class Test {
    public static void main(String[] args) {
        System.out.println("1.1+1.2=" + Calculator.ADD.calculate(1.1, 1.2));
    }
}
```

---
ğŸ‘‰ [æœ¬æ–‡ä»£ç ](https://github.com/gcdd1993/java-design-pattern/tree/master/src/main/java/strategyPattern)
ğŸ‘‰ [è¿”å›è®¾è®¡æ¨¡å¼æ¦‚è§ˆ](../../è®¾è®¡æ¨¡å¼æ¦‚è§ˆ)